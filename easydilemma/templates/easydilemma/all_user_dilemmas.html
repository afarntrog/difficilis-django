<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
      
    {% load static %}
        <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-143158805-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-143158805-1');
  </script>
    <title>Difficilis</title>
    <link rel="shortcut icon" type="image/png" href="{% static 'easydilemma/images/favicon-16x16.png' %}"/>


    <link href="https://fonts.googleapis.com/css?family=Oswald" rel="stylesheet">
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
    <!--My css sheet-->
    <link rel="stylesheet" href="../../static/easydilemma/css/main.css">
    <!--Font Awesome-->
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.1/css/all.css" integrity="sha384-50oBUHEmvpQ+1lW4y57PTFmhCaXp0ML5d60M1M7uH2+nqUivzIebhndOJK28anvf" crossorigin="anonymous">
    <!--jQuery CDN-->
    <script src="https://code.jquery.com/jquery-3.3.1.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous">
    </script>

    <!--jQuery UI local link-->
    <!-- <script src="../../static/easydilemma/jquery-ui-1.12.1/jquery-ui.min.js"></script> -->
    <!--Loading overlay Libary-->
    <!-- <script src="./jquery-loading-overlay-2.1.6/src/loadingoverlay.js"></script> -->
    <script src="../../static/easydilemma/js/main2.js" ></script>
    <script src="../../static/easydilemma/js/ajax_dilemmas.js" ></script>
<script>
    $(document).ready(function() {

    // Add toggle abibilty to the reasons table
    // When user clicks the text box a new field will display showing the entire reason un-truncated.
    // MUST bind function to dynamically added content
    $("body").on("click", ".expand-reason",function() {
        $(this).next().toggle();
    });

    }); // END READY function.
    
</script>
</head>


<!--Make it inherit the first page navbar-->

<body>
      <!--Alert Django messages {https://docs.djangoproject.com/en/dev/ref/contrib/messages/}-->
  {% if messages %}
    {% for message in messages %}
        <div class="container">
            <div class="alert alert-{{ message.tags }} alert-dismissible fade show text-center">
                <button type="button" data-dismiss="alert" class="close">&times;</button>
                <strong> {{ message }}</strong>
             </div>
        </div>
        <!--/Alert-->
        {% endfor %}
    {% endif %}



    <header class="header">
        <!-- Navbar-->
        <nav class="navbar navbar-expand-lg fixed-top shadow navbar-light bg-white">
                <div class="d-flex">
                    <a class="navbar-brand grow" href="{% url 'easydilemma:index' %}"><img src="{% static 'easydilemma/images/Logo.png' %}" id="logo" style="max-height: 30px; max-width: 150px;;"  alt="Difficilis"></a>
                    <!-- If you use the above logo insteas of the one with the text then you have to comment out the logo id in main.css  -->
                    <!--<a href="index.html" class="navbar-brand text-uppercase font-weight-bold"><span>Difficilis</span></a> -->
                    <!-- https://logohub.io/# -->
                </div>
            
            <button type="button" data-toggle="collapse" data-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation"  class="navbar-toggler navbar-toggler-right">
                <i class="fa fa-bars"></i>
            </button>

            <div class="collapse navbar-collapse" id="navbarCollapse">
                <!--Left side of NavBar-->
                <ul class="navbar-nav">
                <li class="nav-item" ><a  href="{% url 'easydilemma:index' %}" class="nav-link font-weight-bold">Home</a></li>
                <li class="nav-item "><a  href="{% url 'easydilemma:popular_dilemmas' %}" class="nav-link font-weight-bold">Popular</a></li>
                <li class="nav-item"><a  href="{% url 'easydilemma:newest_dilemmas' %}" class="nav-link font-weight-bold">Newest</a></li>
                <li class="nav-item"><a  href="{% url 'easydilemma:all_dilemmas' %}" class="nav-link font-weight-bold">All Dilemmas</a></li>

                </ul>
                <!--Right side of NavBar-->
                <ul class="navbar-nav ml-auto">
                    {% if user.is_authenticated %}
                    <li class="nav-item ml-lg-3 dropdown ">
                        <a class="nav-item nav-link dropdown-toggle mr-md-2" href="#" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">{{ user.username }}</a>
                          <div class="dropdown-menu dropdown-menu-right" aria-labelledby="dropdownMenuButton">
                            <a class="dropdown-item text-muted" href="{% url 'easydilemma:dilemma' %}">New dilemma</a>
                            <a class="dropdown-item text-muted" href="{% url 'users:profile_update' %}">Change username</a>
                            <a class="dropdown-item text-muted" href="{% url 'users:logout' %}">Logout</a>
                            <a class="dropdown-item text-muted" href="{% url 'users:del_user' %}" onclick="return confirm('Are you sure you want to delete your account? This action is permanent.')">Delete account</a>
                            <div class="dropdown-divider"></div>
                            <a  href="{% url 'easydilemma:all_user_dilemmas' %}" class="dropdown-item text-success"><strong>My Dilemmas</strong></a>
                        </div>
                    </li>
                    {% else %}
                    <li class="nav-item ml-lg-3 "><a  href="{% url 'easydilemma:dilemma' %}" class="btn btn-primary"><strong>New Dilemma</strong></a></li>
                    <li class="nav-item ml-lg-3 "><a  href="{% url 'users:login' %}" class="btn btn-outline-primary navbar_btn" ><strong>LOG IN</strong></a></li>
                    {% endif %}
                </ul>
            </div>
        </nav>
        <!-- /Navbar -->
        </header>

        <!--The finnished dilemma card will go here-->
        <div id="add-content">                   
                

        </div>



    <!-- <script>
        $(document).ready(function() {
            $(".expand-reason").on("click", function() {
                $(this).next().toggle();
            });
    
        });
    </script> -->

{% if all_dilemmas|length > 0 %} <!--Make sure that there are some dilemmas for this user if not display message below-->
    {% for dilemma in all_dilemmas %}
        <!--TOGGLE CLASS-->
        <div class="container mb-5">
                <div class="card w-75 mx-auto">
                    <div class="card-header">
                        {% if dilemma.user is None %}
                            <span class="small badge badge-pill badge-primary font-weight-normal float-right mt-2 align-middle">anonymous_45{{ dilemma.id }}</span>
                        {% else %}
                            <span class="small badge badge-pill badge-primary font-weight-normal float-right mt-2 align-middle">{{ dilemma.user }}</span>
                        {% endif %}
                            
                        <h5>{{ dilemma.dilemma_part_one.dilemma_part_one }} or {{ dilemma.dilemma_part_two.dilemma_part_two }}</h5>
                    </div> 
                    <div class="card-body">
                        <div class="row mb-3 ml-2">
                            <span class="badge badge-pill badge-secondary text-truncate">Reasons for: {{ dilemma.dilemma_part_one.dilemma_part_one }}</span>
                        </div>
                        {% for reason in dilemma.dilemma_part_one.reason_part_one.all %}
                            <div class="row mb-3">
                                <div class="col-md-8">
                                    <input type="text" class="form-control font-weight-bold expand-reason text-truncate" value="{{ reason.reason }}" readonly>
                                    <div class="p-2 mb-3 rounded text-dark font-weight-bold border text-center bg-light" style="display: none" id="full-reason-div">{{ reason.reason }}</div>
                                </div>
                                <div class="col-md-4">
                                        {% if reason.selected_option == "1" %}
                                            <input type="text" class="form-control text-center font-weight-bold" value="Not Really Important" readonly>
                                        {% elif reason.selected_option == "2" %}
                                            <input type="text" class="form-control text-center font-weight-bold" value="Somewhat Important" readonly>
                                        {% elif reason.selected_option == "3" %}
                                            <input type="text" class="form-control text-center font-weight-bold" value="Important" readonly>
                                        {% elif reason.selected_option == "4" %}
                                            <input type="text" class="form-control text-center font-weight-bold" value="Very Important" readonly>
                                        {% elif reason.selected_option == "5" %}
                                            <input type="text" class="form-control text-center font-weight-bold" value="Extremely Important" readonly>
                                        {% endif %}
                                </div>
                            </div>
                        {% endfor %}

                        <hr>
                        <div class="row mb-3 ml-2">
                            <span class="badge badge-pill badge-secondary text-truncate">Reasons for: {{ dilemma.dilemma_part_two.dilemma_part_two }}</span>
                        </div>
                        {% for reason in dilemma.dilemma_part_two.reason_part_two.all %}
                            <div class="row mb-3">
                                <div class="col-md-8">
                                    <input type="text" class="form-control font-weight-bold expand-reason text-truncate" value="{{ reason.reason }}" readonly>
                                    <div class="p-2 mb-3 rounded text-dark font-weight-bold border text-center bg-light" style="display: none" id="full-reason-div">{{ reason.reason }}</div>
                                </div>
                                <div class="col-md-4">
                                        {% if reason.selected_option == "1" %}
                                            <input type="text" class="form-control text-center font-weight-bold" value="Not Really Important" readonly>
                                        {% elif reason.selected_option == "2" %}
                                            <input type="text" class="form-control text-center font-weight-bold" value="Somewhat Important" readonly>
                                        {% elif reason.selected_option == "3" %}
                                            <input type="text" class="form-control text-center font-weight-bold" value="Important" readonly>
                                        {% elif reason.selected_option == "4" %}
                                            <input type="text" class="form-control text-center font-weight-bold" value="Very Important" readonly>
                                        {% elif reason.selected_option == "5" %}
                                            <input type="text" class="form-control text-center font-weight-bold" value="Extremely Important" readonly>
                                        {% endif %}                        
                                </div>
                            </div>
                        {% endfor %}
                    </div>

            <div class="card-footer">
                        
                <h5 class="text-large font-weight-bold">Result: {{ dilemma.result }} </span> </h5>
                <div class="float-right col-sm-12  pt-3 border-top">
                    {% if not dilemma.should_post %}
                        <a  href="{% url 'users:make_public' dilemma.id %}" class="btn float-right btn-outline-success ml-4 ">Make Public</a>
                    {% else %}
                    <a  href="{% url 'users:make_private' dilemma.id %}" class="btn float-right btn-outline-danger ml-4 ">Make Private</a>
                    {% endif %}
                    <a  href="{% url 'users:del_dilemma' dilemma.id %}" class="btn float-right btn-danger ">Delete</a>
                    <a href="{% url 'easydilemma:disclaimer' %}" target="_blank"><small class="text-muted">Disclaimer</small></a>
                </div>
                
            </div>



            </div>
        </div>
    {% endfor %}
    <br> <br>


    {% if all_dilemmas.has_other_pages %}
        <div class="container d-flex justify-content-center">
                <!-- <div class="card w-75 mx-auto"> -->
        <nav aria-label="Page navigation example">
                <ul class="pagination">
                    {% if all_dilemmas.has_previous %}
                        <li class="page-item"><a class="page-link" href="?page={{ all_dilemmas.previous_page_number }}">Previous</a></li>
                    {% else %}
                        <li class="page-item disabled"><a class="page-link" >Previous</a></li>
                    {% endif %}

                    {% for i in all_dilemmas.paginator.page_range %}
                        {% if all_dilemmas.number == i %}
                            <li class="active page-item"><a class="page-link" href="?page={{ i }}">{{ i }}<span class="sr-only">(current)</span></a></li>
                        {% else %}
                            <li class="page-item"><a class="page-link" href="?page={{ i }}">{{ i }}</a></li>
                        {% endif %}
                            
                    {% endfor %}
                    {% if all_dilemmas.has_next %}
                        <li class="page-item"><a class="page-link" href="?page={{ all_dilemmas.next_page_number }}">Next</a></li>
                    {% else %}
                    <li class="page-item disabled"><a class="page-link" >Next</a></li>
                    {% endif %}
                    
                </ul>
            </nav>
                </div>
        <!-- </div> -->

    {% endif %}


<!-- If user has no dilemmas then display below template -->
{% else %}
<div class="jumbotron jumbotron-fluid">
        <div class="container text-center">
          <h1 class="display-4">You have no dilemmas</h1>
          <hr class="my-4">
          <p class="lead">
                <a  href="{% url 'easydilemma:dilemma' %}" class="btn btn-lg btn-primary "><strong>New Dilemma</strong></a>
              </p>
        </div>
      </div>
{% endif %}


    
  <!-- <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script> -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>


</body>
</html>